<div class="tab_header" [ngStyle]="{'top' : hideHeader}">Gestion des utilisateurs<span (click)="plusDoption()" class="more"><ion-icon name="more"></ion-icon></span></div>
<div *ngIf="ifHasConnection" class="freedrinkstab" [ngStyle]="{'top' : hideSubHeader}">
  <div (click)="tous()" [ngStyle]="{'color' : activeColor1}">Tous <span class="rippleEffect"></span></div>
  <div (click)="abonne()" [ngStyle]="{'color' : activeColor2}">Abonné</div>
  <div (click)="nonabonne()" [ngStyle]="{'color' : activeColor3}">Non abonné</div>
  <div (click)="termine()" [ngStyle]="{'color' : activeColor4}">Terminé</div>
  <span class="outline_bar" [ngStyle]="{'transform' : tabPosition, 'left' : leftPosition}"></span>
</div>

<!-- Custom Refresher Start -->
<div class="cpr_frontdrop" [ngStyle]="{'display' : popFD}"></div>
<div class="cp_refresher_wrapper" [ngClass]="{double_header : ifHasConnection}" [ngStyle]="{'transform' : posY, 'transition' : animDur}">
  <div class="custom_pull_refresher"><img src="../../assets/img/custom_pull_refresher_arrow.svg" [ngStyle]="{'animation' : rotate}"></div>
</div>
<!-- Custom Refresher End -->

<ion-content [ngStyle]="{'opacity' : mainOpac}" [forceOverscroll]="true" *ngIf="ifHasConnection" color="secondary" class="mainContent" [scrollEvents]="true" (ionScroll)="scrollEvent($event)" (touchmove)="pull($event)" (touchstart)="pullstart($event)" (touchend)="endpull()">
  <ion-searchbar animated color="primary" placeholder="Rechercher un utilisateur" (ionInput)="search($event)"></ion-searchbar>

  <p *ngIf="padDeDonee" class="pasDeDonnee"><ion-icon name="information-circle"></ion-icon>&nbsp;&nbsp;Aucun utilisateur</p>

  <ion-list>
    <ion-item-sliding *ngFor="let user of usersFilter; let i = index" #slidingItem>
      <span class="voirPlus" (click)="expand(i)"><ion-icon name="arrow-dropdown"></ion-icon></span>
      <ion-item lines="none" no-padding (click)="expand(i)">
        <div class="content">
            <h1>{{user.INT_PRENOM}}</h1>
            <h3>{{user.INT_EMAIL}}</h3>
            <span class="n-ab" *ngIf="(user.ABO_DATEDEBUT === null || user.ABO_DATEFIN === null) && user.Roles_ROL_ID === 3">non-abonné</span>
            <span class="ab" *ngIf="(user.ABO_DATEDEBUT !== null || user.ABO_DATEFIN !== null) && today < user.ABO_DATEFIN && user.Roles_ROL_ID === 3">abonné</span>
            <span class="ab-t" *ngIf="(user.ABO_DATEDEBUT !== null || user.ABO_DATEFIN !== null) && today > user.ABO_DATEFIN && user.Roles_ROL_ID === 3">abonnement terminé</span>
            <span class="ab-vip" *ngIf="user.Roles_ROL_ID === 4">V.I.P</span>
            <span class="ab-partner" *ngIf="user.Roles_ROL_ID === 2">Partenaire</span>
            <div class="sub_content" id="sub_content_{{i}}">
                <h2 *ngIf="user.INT_THIRD_PARTY_LOGIN!==null">Type&nbsp;d'inscription: {{user.INT_THIRD_PARTY_LOGIN}}</h2>
                <h2 *ngIf="user.INT_THIRD_PARTY_LOGIN===null">Type&nbsp;d'inscription: NATIVE</h2>
                <p>Date&nbsp;d'inscription:&nbsp;<ion-datetime [readonly]="true" [value]="user.INT_DATEINSCRIPTION" displayFormat="DD MMMM YYYY" month-names="Janvier, Février, Mars, Avril, Mai, Juin, Juillet, Août, Décembre"></ion-datetime></p>
                <hr>
                <p *ngIf="user.ABO_TYPE!==null">Type&nbsp;d'abonnement:&nbsp;{{user.ABO_TYPE}}</p>
                <p *ngIf="user.ABO_TYPE===null">Type&nbsp;d'abonnement:&nbsp;<i>non-abonné</i></p>

                <p *ngIf="user.ABO_DATEDEBUT!==null">Début:&nbsp;{{user.startFR}}</p>
                <p *ngIf="user.ABO_DATEDEBUT===null">Début:&nbsp;<i>non-abonné</i></p>

                <p *ngIf="user.ABO_DATEFIN!==null">Fin:&nbsp;{{user.endFR}}</p>
                <p *ngIf="user.ABO_DATEFIN===null">Fin:&nbsp;<i>non-abonné</i></p>
              </div>
        </div>
      </ion-item>
      <ion-item-options side="start">
        <!-- <ion-item-option  (click)="edit(slidingItem,user.INT_ID, user.INT_PRENOM, user.INT_NOM, user.INT_EMAIL, user.ROL_TYPES)"><ion-icon class="ion-edit" name="settings"></ion-icon></ion-item-option> -->
        <ion-item-option  (click)="sendEmail(user.INT_EMAIL)" class="ContactOpt"><ion-icon class="ion-delete" name="mail"></ion-icon></ion-item-option>
        <!--  -->
        <ion-item-option *ngIf="(user.ABO_DATEDEBUT === null || user.ABO_DATEFIN === null)"  (click)="delete(slidingItem,user.INT_ID, user.INT_PRENOM)" class="deleteOpt"><ion-icon class="ion-delete" name="trash"></ion-icon></ion-item-option>
        <ion-item-option *ngIf="(user.ABO_DATEDEBUT !== null || user.ABO_DATEFIN !== null) && today > user.ABO_DATEFIN" (click)="delete(slidingItem,user.INT_ID, user.INT_PRENOM)" class="deleteOpt"><ion-icon class="ion-delete" name="trash"></ion-icon></ion-item-option>
        <ion-item-option *ngIf="(user.ABO_DATEDEBUT !== null || user.ABO_DATEFIN !== null) && today < user.ABO_DATEFIN" (click)="cantDelete(slidingItem, user.INT_PRENOM)" class="deleteOpt"><ion-icon class="ion-delete" name="trash"></ion-icon></ion-item-option>
        <!--  -->
        <ion-item-option *ngIf="user.Roles_ROL_ID !== 4 && user.Roles_ROL_ID !== 2" (click)="editRole(slidingItem,user.INT_ID, user.INT_PRENOM, 2)" class="assignPartnerOpt"><ion-icon class="ion-role" src="../../assets/img/partner.svg"></ion-icon></ion-item-option>
        <ion-item-option *ngIf="user.Roles_ROL_ID !== 4 && user.Roles_ROL_ID == 2" (click)="editRole(slidingItem,user.INT_ID, user.INT_PRENOM, 3)" class="assignPartnerOpt"><ion-icon class="ion-role" src="../../assets/img/unpartner.svg"></ion-icon></ion-item-option>
        <ion-item-option *ngIf="user.Roles_ROL_ID !== 4 && user.Roles_ROL_ID !== 2" (click)="makeVip(slidingItem,user.INT_ID, user.INT_PRENOM)" class="assignVipOpt"> <img src="../../assets/img/crown.svg"></ion-item-option>
        <ion-item-option *ngIf="user.Roles_ROL_ID === 4" (click)="makeUnVip(slidingItem,user.INT_ID, user.INT_PRENOM)" class="assignVipOpt"> <img src="../../assets/img/uncrown.svg"></ion-item-option>
      </ion-item-options>
    </ion-item-sliding>
  </ion-list>
  <p>{{haveUserOrNot}} </p>
</ion-content>

<ion-content [ngStyle]="{'opacity' : mainOpac}" [forceOverscroll]="false" *ngIf="!ifHasConnection" color="secondary" class="mainContent noConnContent" [scrollEvents]="true" (ionScroll)="scrollEvent($event)" (touchmove)="pull($event)" (touchstart)="pullstart($event)" (touchend)="endpull()">
    <div class="no_connection">
    <img src="../../assets/img/no_connection.svg">
    <h1>Veuillez vous assurer que votre appareil est connecté au réseau.</h1>
  </div>
</ion-content>